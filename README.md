# lms

https://github.com/Valentina810/lms

## Участники команды

#### Java Developer

- [Валентина](https://github.com/Valentina810)
- [Роман](https://github.com/Yudiol)

#### Frontend Developer (React)

- [Анна](https://github.com/AnnaSog)

#### Manual QA

- [Евгения](https://github.com/janekomarovskaja)

## Ссылка на фигму

https://www.figma.com/file/V7PLGct4lGmFJofvvbgxkw/LMS-(Copy)?type=design&node-id=0-1&mode=design&t=zOfw4q4RFrdDYrCx-0

## Сваггер реальный

http://195.161.68.231:8080/swagger-ui/index.html

## Сваггер мок-сервиса

https://mock-service-for-lms-git-valentinakolesnikova-dev.apps.sandbox-m4.g2pi.p1.openshiftapps.com/swagger-ui/index.html  
Сваггер мока, развернут в песочнице, поэтому при первом запросе может быть большой таймаут

## Доска

https://github.com/users/Valentina810/projects/1

## Схема БД

![Схема базы данных](https://github.com/Valentina810/lms/blob/main/schema.png)

## Мини-lms система для родителей, которые организуют семейное обучение детей дома

Первоначальный MVP не предусматривает регистрацию пользователей.
Считаем что пользователь уже зарегистрирован. В таблице Users хранятся данные о пользователе: логин, пароль и токен.

## Эндпоинты

### Контроллер /users

#### Запрос POST /users - создание пользователя, возвращает пользователя (для теста, в  UI интерфейсе регистрации пока не будет)

##### Специальные заголовки:

Content-Type : application/json

##### Тело

```
  {
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "password":"apple",
  "email":"vasek@mail.ru",
  "datBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
```

#### Ответ

##### Специальные заголовки: нет

##### Тело

```
  {
  "id":"1",
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "email":"vasek@mail.ru",
  "datBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
```

##### Возможные коды ответа:

- 201 - пользователь успешно создан
- 400 - в теле запроса ошибка
- 403 - нет прав для создания пользователя
- 409 - конфликт (например, пользователь с таким email уже существует в БД)
- 500 - неизвестная ошибка сервера

Ответы в случае ошибок

| Ошибка | Дополнительная информация                         |Ответ                                                                                                                                              |
|--------|---------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| 400    | Ошибка в JSON                                     |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Неверная структура объекта: проверьте скобки, запятые и названия полей",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Имя/пустое                       |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Имя обязательно для заполнения; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Логин/пустое                     |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Login не должен быть пустым; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Password/пустое                  |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Пароль не должен быть пустым",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Email/пустое                     |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Поле Email обязательно для заполнения; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 403    | нет                                               |{<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}                      |
| 409    | Пользователь с указанным  Email <br/>уже есть в БД |{<br/>"status": "CONFLICT",  <br/>"message": "Эта электронная почта уже существует в базе данных",  <br/>"date": "2023-09-11 19:06:04"<br/>}       |
| 500    | нет                                               |{<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>}                  |

#### Запрос PATCH /users/{userId} - изменение информации о пользователе

##### Специальные заголовки:

Content-Type : application/json

##### Тело

```
  {
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "password":"apple",
  "email":"vasek@mail.ru",
  "dateBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
```

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные о пользователе с учетом обновления

```
  {
  "id_user":2,
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "email":"vasek@mail.ru",
  "dateBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
  ```

##### Возможные коды ответа:

- 200 - данные пользователя успешно изменены
- 400 - в теле запроса ошибка
- 403 - нет прав для изменения данных
- 409 - конфликт (например, пользователь с таким email уже существует в БД и это не ткущий пользователь)
- 500 - неизвестная ошибка сервера

| Ошибка | Дополнительная информация        |Ответ                                                                                                                                              |
|--------|----------------------------------|--------------------------------------------------------------------------------------------------------------------------|
| 400    | Ошибка в JSON                    |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Неверная структура объекта: проверьте скобки, запятые и названия полей",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Имя/пустое      |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Имя обязательно для заполнения; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Логин/пустое    |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Login не должен быть пустым; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Password/пустое |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Пароль не должен быть пустым",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 400    | Не передано поле Email/пустое    |{<br/>"status": "BAD_REQUEST",  <br/>"message": "Поле Email обязательно для заполнения; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 403    | нет                              |{<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}                      |
| 409    | Пользователь с указанным  Email <br/>уже есть в БД                              |{<br/>"status": "CONFLICT",  <br/>"message": "Эта электронная почта уже существует в базе данных",  <br/>"date": "2023-09-11 19:06:04"<br/>}       |
| 500    | нет                              |{<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>}                  |

#### Запрос GET /users/{userId} - получение информации о пользователе (Имя, Фамилия, Логин, Дата рождения, Дата регистрации, Аватар)

##### Специальные заголовки: нет

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные о пользователе

```
  {
  "id_user":2,
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "email":"vasek@mail.ru",
  "date_birth":"2000-01-01",
  "dateRegistration":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
  ```

##### Возможные коды ответа:

- 200 - данные пользователя успешно получены
- 403 - нет прав для получения данных
- 404 - по данному id пользователь не найден
- 500 - неизвестная ошибка сервера

| Ошибка | Ответ                                                                                                                             |
|--------|-----------------------------------------------------------------------------------------------------------------------------------|
| 403    | {<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}                 |
| 404    | {<br/>"status": "NOT_FOUND",  <br/>"message": "Пользователь c id 10 не найден ",  <br/>"date": "2023-09-11 19:06:04"<br/>}        |
| 500    | {<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>} |

### Контроллер /users/lessons

#### Запрос GET /users/{userId}/lessons?from=2020-12-25&&to=2020-12-31 - получение информации о запланированных пользователем уроках в заданном диапазоне, включая указанные даты. Если параметры не указаны - то возвращаются уроки за текущую неделю. Список отсортирован от меньшей даты к большей. Список параметров по каждому событию:

- Дата
- Время начала
- Время окончания
- Название предмета
- Прогресс
- Отметка о выполнении (выставляется при % выполнения 100 автоматически или вручную при любом % выполнения - за это
  отвечает бэк)

##### Специальные заголовки:

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: массив уроков за указанный диапазон, отсортированный от меньшей даты к большей

```
[{
        "idLesson":1,
		"subject": {
			"idSubject": 2,
			"name": "Математика"
		},
		"date": "2023-09-04",
		"timeStart": "10:00:00",
		"timeEnd": "10:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":2,
		"subject": {
			"idSubject": 1,
			"name": "Русский язык"
		},
		"date": "2023-09-04",
		"timeStart": "11:00:00",
		"timeEnd": "11:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":3,
		"subject": {
			"idSubject": 3,
			"name": "Технология"
		},
		"date": "2023-09-04",
		"timeStart": "12:00:00",
		"timeEnd": "12:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":4,
		"subject": {
			"idSubject": 2,
			"name": "Математика"
		},
		"date": "2023-09-05",
		"timeStart": "10:00:00",
		"timeEnd": "10:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":5,
		"subject": {
			"idSubject": 3,
			"name": "Технология"
		},
		"date": "2023-09-05",
		"timeStart": "11:00:00",
		"timeEnd": "11:40:00",
		"progress": 0,
		"checkSuccessfully": false
	}
]
```

##### Возможные коды ответа:

- 200 - данные успешно получены
- 400 - ошибка в строке запроса
- 403 - нет прав для получения данных
- 500 - неизвестная ошибка сервера

| Ошибка | Дополнительная информация                               | Ответ                                                                                                                                       |
|--------|---------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------|
| 400    | Ошибка в строке запроса <br/>(например, несуществующая дата) | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Неверный параметр запроса: проверьте параметры",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 403    | нет                                                     | {<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}                 |
| 500    | нет                                                     | {<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>}           |

#### Запрос GET /users/{userId}/lessons/{lessonId}- получение информации о конкретном уроке. Возвращаются данные:

- Дата
- Время начала
- Время окончания
- Название предмета
- Ссылка на теорию (ссылка на файл, пока просто храним как строку)
- Ссылка на практическое задание (ссылка на файл, пока просто храним как строку)
- Ссылка на домашнюю рабооту (ссылка на файл, пока просто храним как строку)
- % выполнения (от 0 до 100%)
- Отметка о выполнении (выставляется при % выполнения 100 автоматически или вручную при любом % выполнения)

##### Специальные заголовки: нет

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные об уроке с указанным id

```
{
	"idLesson": 5,
	"subject": {
		"idSubject": 2,
		"name": "Математика"
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

##### Возможные коды ответа:

- 200 - данные успешно получены
- 403 - нет прав для получения данных
- 404 - урок не найден
- 500 - неизвестная ошибка сервера

| Ошибка | Дополнительная информация                                    | Ответ                                                                                                                                  |
|--------|--------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------|
| 403    | нет                                                          | {<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}            |
| 404    | Урок у указанного пользователя <br/>с указанныи id не найден | {<br/>"status": "NOT_FOUND",  <br/>"message": "У пользователя с id 1 не найден урок с id 1",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 500    | нет                                                          | {<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>}      |

#### Запрос POST /users/{userId}/lessons - создание нового урока, в теле данные урока

##### Специальные заголовки:

Content-Type : application/json

##### Тело:

```
{
	"subject": {
		"idSubject": 2,
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные о созданном уроке

```
{
	"idLesson": 5,
	"subject": {
		"idSubject": 2,
		"name": "Математика"
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

##### Возможные коды ответа:

- 201 - урок успешно создан
- 400 - ошибка в запросе
- 403 - нет прав для создания урока
- 500 - неизвестная ошибка сервера

| Ошибка | Дополнительная информация               | Ответ                                                                                                                                                                  |
|--------|-----------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 400    | Ошибка в JSON                           | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Неверная структура объекта: проверьте скобки, запятые и названия полей",  <br/>"date": "2023-09-11 19:06:04"<br/>}                    |
| 400    | Не указан id предмета                   | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Id предмета обязательно должен быть указан для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}           |
| 400    | Не указана тема урока/пустая            | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Тема урока обязательно должна быть указана для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}           |
| 400    | Не указана дата урока/пустая            | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Дата урока обязательно должна быть указана для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}           |
| 400    | Не указано время начала урока/пустое    | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Время начала урока обязательно должно быть указано для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}   |
| 400    | Не указано время окончания урока/пустое | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Время окончания урока обязательно должно быть указано для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 403    | нет                                     | {<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}                                                 |
| 404    | Указан предмет с несуществующим id      | {<br/>"status": "NOT_FOUND",  <br/>"message": "Предмет c id 0 не найден",  <br/>"date": "2023-09-11 19:06:04"<br/>}                                                    |
| 500    | нет                                     | {<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>}                                      |

#### Запрос PATCH /users/{userId}/lessons/{lessonId} - изменение урока, в теле данные урока

##### Специальные заголовки:

Content-Type : application/json

##### Тело:

```
{
	"subject": {
		"idSubject": 2
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

#### Ответ

##### Специальные заголовки: нет

##### Тело: обновленная информация об уроке

```
{
	"idLesson": 5,
	"subject": {
		"idSubject": 2,
		"name": "Математика"
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

##### Возможные коды ответа:

- 200 - данные успешно обновлены
- 400 - ошибка в запросе
- 403 - нет прав для изменения данных
- 404 - урок не найден
- 500 - неизвестная ошибка сервера

| Ошибка | Дополнительная информация               | Ответ                                                                                                                                                                   |
|--------|-----------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 400    | Ошибка в JSON                           | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Неверная структура объекта: проверьте скобки, запятые и названия полей",  <br/>"date": "2023-09-11 19:06:04"<br/>}                     |
| 400    | Не указан id предмета                   | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Id предмета обязательно должен быть указан для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}            |
| 400    | Не указана тема урока/пустая            | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Тема урока обязательно должна быть указана для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}            |
| 400    | Не указана дата урока/пустая            | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Дата урока обязательно должна быть указана для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}            |
| 400    | Не указано время начала урока/пустое    | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Время начала урока обязательно должно быть указано для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>}    |
| 400    | Не указано время окончания урока/пустое | {<br/>"status": "BAD_REQUEST",  <br/>"message": "Время окончания урока обязательно должно быть указано для создания урока; ",  <br/>"date": "2023-09-11 19:06:04"<br/>} |
| 403    | нет                                     | {<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}                                            |
| 404    | Указан предмет с несуществующим id      | {<br/>"status": "NOT_FOUND",  <br/>"message": "Предмет c id 0 не найден",  <br/>"date": "2023-09-11 19:06:04"<br/>}                                                     |
| 404    | Урок с указанным id не найден           | {<br/>"status": "NOT_FOUND",  <br/>"message": "Урок c id 0 не найден",  <br/>"date": "2023-09-11 19:06:04"<br/>}                                                        |
| 500    | нет                                     | {<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>}                                       |

#### Запрос DELETE /users/{userId}/lessons/{lessonId} - удаление урока

##### Специальные заголовки:нет

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: нет

##### Возможные коды ответа:

- 204 - урок успешно удален
- 404 - урок не найден
- 403 - нет прав для удаления урока
- 500 - неизвестная ошибка сервера


| Ошибка | Дополнительная информация               | Ответ                                                                                                                             |
|--------|-----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| 403    | нет                                     | {<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}            |
| 404    | Урок с указанным id не найден           | {<br/>"status": "NOT_FOUND",  <br/>"message": "Урок c id 0 не найден",  <br/>"date": "2023-09-11 19:06:04"<br/>}                  |
| 500    | нет                                     | {<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>} |

### Контроллер /subjects

#### Запрос GET /subjects - возвращает список предметов

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: массив предметов

```
[{
		"subject": {
			"idSubject": 1,
			"name": "Математика"
		}
	},
	{
		"subject": {
			"idSubject": 2,
			"name": "Русский язык"
		}
	},
	{
		"subject": {
			"idSubject": 3,
			"name": "Технология"
		}
	}
]
  ```

##### Возможные коды ответа:

- 200 - данные успешно получены
- 403 - нет прав для получения данных
- 500 - неизвестная ошибка сервера


| Ошибка | Дополнительная информация               | Ответ                                                                                                                             |
|--------|-----------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------|
| 403    | нет                                     | {<br/>"status": "FORBIDDEN",  <br/>"message": "Нет прав для совершения операции",  <br/>"date": "2023-09-11 19:06:04"<br/>}       |
| 500    | нет                                     | {<br/>"status": "INTERNAL_SERVER_ERROR",  <br/>"message": "Неизвестная ошибка сервера",  <br/>"date": "2023-09-11 19:06:04"<br/>} |


## Фичи для дальнейшего развития

- добавить регистрацию и авторизацию
- добавить проверку при создании урока на пересечение урока с уже существующими (если урок пересекается с другим,
  сообщать об этом и урок не создавать)
- добавить вывод в интрефейс по дням, неделям, месяцам (?)