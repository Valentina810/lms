# lms

## Сваггер проекта

http://localhost:8080/swagger-ui/index.html (локально)

Сваггер мока, развернут в песочнице, поэтому при первом запросе может быть большой таймаут
https://mock-service-for-lms-git-valentinakolesnikova-dev.apps.sandbox-m4.g2pi.p1.openshiftapps.com/swagger-ui/index.html

## Схема БД

![Схема базы данных](https://github.com/Valentina810/lms/blob/main/schema.png)

## Примерный дизайн

https://www.figma.com/file/GoNQ6PeA0VtruUAWO1YlG1/LMS?type=design&mode=design&t=Ja79CpR8ynN0eVMP-1

## Мини-lms система для родителей, которые организуют семейное обучение детей дома

Первоначальный MVP не предусматривает регистрацию пользователей.
Считаем что пользователь уже зарегистрирован. В таблице Users хранятся данные о пользователе: логин, пароль и токен.
Для получения информации о пользователе необходимо сформировать запрос, передав в заголовке Authorization токен
пользователя
(заглушка для будущей авторизации).

## Эндпоинты
### Контроллер /users

#### Запрос POST /users - создание пользователя, возвращает токен пользователя (для теста, в  UI интерфейсе регистрации пока не будет)

##### Специальные заголовки: 
Content-Type : application/json

##### Тело

```
  {
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "password":"apple",
  "email":"vasek@mail.ru",
  "datBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
```

#### Ответ

##### Специальные заголовки: нет

##### Тело

```
  {
  "id":"1",
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "password":"apple",
  "email":"vasek@mail.ru",
  "datBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
```

##### Возможные коды ответа:

- 201 - пользователь успешно создан
- 400 - в теле запроса ошибка (неверное название поля, не указан обязательный параметр)
- 409 - конфликт (например, пользователь с таким email уже существует в БД)
- 500 - неизвестная ошибка сервера

Если возникла ошибка, то нужно в теле ответа возвращать причину ошибки

#### Запрос PATCH /users/{userId} - изменение информации о пользователе

##### Специальные заголовки:
Content-Type : application/json  
Authorization : токен_пользователя

##### Тело

```
  {
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "password":"apple",
  "email":"vasek@mail.ru",
  "dateBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
```

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные о пользователе с учетом обновления

```
  {
  "id_user":2,
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "password":"apple",
  "email":"vasek@mail.ru",
  "dateBirth":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
  ```

##### Возможные коды ответа:

- 200 - данные пользователя успешно изменены
- 400 - в теле запроса ошибка (неверное название поля, не указан обязательный параметр)
- 401 - пользователь не авторизован
- 409 - конфликт (например, пользователь с таким email уже существует в БД и это не ткущий пользователь)
- 500 - неизвестная ошибка сервера

Если возникла ошибка, то нужно в теле ответа возвращать причину ошибки

#### Запрос GET /users/{userId} - получение информации о пользователе (Имя, Фамилия, Логин, Дата рождения, Дата регистрации, Аватар)

##### Специальные заголовки:

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные о пользователе

```
  {
  "id_user":2,
  "name": "Василий",
  "surname":"Петров", 
  "login":"Vasek",
  "password":"apple",
  "email":"vasek@mail.ru",
  "date_birth":"2000-01-01",
  "dateRegistration":"2000-01-01",
  "avatarUrl":"https://pgcookbook.ru/programming/vasia.jpg"
  }
  ```

##### Возможные коды ответа:

- 200 - данные пользователя успешно получены
- 404 - по данному токену пользователь не найден
- 500 - неизвестная ошибка сервера

Если возникла ошибка, то нужно в теле ответа возвращать причину ошибки

### Контроллер /users/lessons

#### Запрос GET /users/{userId}/lessons?from=2020-12-25&&to=2020-12-31 - получение информации о запланированных пользователем уроках в заданном диапазоне, включая указанные даты. Если параметры не указаны - то возвращаются уроки за текущую неделю. Список отсортирован от меньшей даты к большей. Список параметров по каждому событию:

- Дата
- Время начала
- Время окончания
- Название предмета
- Прогресс
- Отметка о выполнении (выставляется при % выполнения 100 автоматически или вручную при любом % выполнения - за это
  отвечает бэк)

##### Специальные заголовки:


##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: массив уроков за указанный диапазон, отсортированный от меньшей даты к большей

```
[{
        "idLesson":1,
		"subject": {
			"idSubject": 2,
			"name": "Математика"
		},
		"date": "2023-09-04",
		"timeStart": "10:00:00",
		"timeEnd": "10:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":2,
		"subject": {
			"idSubject": 1,
			"name": "Русский язык"
		},
		"date": "2023-09-04",
		"timeStart": "11:00:00",
		"timeEnd": "11:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":3,
		"subject": {
			"idSubject": 3,
			"name": "Технология"
		},
		"date": "2023-09-04",
		"timeStart": "12:00:00",
		"timeEnd": "12:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":4,
		"subject": {
			"idSubject": 2,
			"name": "Математика"
		},
		"date": "2023-09-05",
		"timeStart": "10:00:00",
		"timeEnd": "10:40:00",
		"progress": 0,
		"checkSuccessfully": false
	},
	{
	    "idLesson":5,
		"subject": {
			"idSubject": 3,
			"name": "Технология"
		},
		"date": "2023-09-05",
		"timeStart": "11:00:00",
		"timeEnd": "11:40:00",
		"progress": 0,
		"checkSuccessfully": false
	}
]
```

##### Возможные коды ответа:

- 200 - данные успешно получены
- 400 - ошибка в строке запроса
- 403 - нет прав для получения данных
- 500 - неизвестная ошибка сервера

#### Запрос GET /users/{userId}/lessons/{lessonId}- получение информации о конкретном уроке. Возвращаются данные:

- Дата
- Время начала
- Время окончания
- Название предмета
- Ссылка на теорию (ссылка на файл, пока просто храним как строку)
- Ссылка на практическое задание (ссылка на файл, пока просто храним как строку)
- Ссылка на домашнюю рабооту (ссылка на файл, пока просто храним как строку)
- % выполнения (от 0 до 100%)
- Отметка о выполнении (выставляется при % выполнения 100 автоматически или вручную при любом % выполнения)

##### Специальные заголовки:

Authorization: токен_пользователя

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные об уроке с указанным id

```
{
	"idLesson": 5,
	"subject": {
		"idSubject": 2,
		"name": "Математика"
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

##### Возможные коды ответа:

- 200 - данные успешно получены
- 400 - ошибка в строке запроса
- 403 - нет прав для получения данных
- 500 - неизвестная ошибка сервера

#### Запрос POST /users/{userId}/lessons - создание нового урока, в теле данные урока

##### Специальные заголовки:
Content-Type : application/json  
Authorization : токен_пользователя

##### Тело:

```
{
	"subject": {
		"idSubject": 2,
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

#### Ответ

##### Специальные заголовки: нет

##### Тело: данные о созданном уроке

```
{
	"idLesson": 5,
	"subject": {
		"idSubject": 2,
		"name": "Математика"
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

##### Возможные коды ответа:

- 204 - урок успешно создан
- 400 - ошибка в запросе
- 403 - нет прав для создания урока
- 500 - неизвестная ошибка сервера

#### Запрос PATCH /users/{userId}/lessons/{lessonId} - изменение урока, в теле данные урока

##### Специальные заголовки:
Content-Type : application/json
Authorization : токен_пользователя

##### Тело:

```
{
	"subject": {
		"idSubject": 2,
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

#### Ответ

##### Специальные заголовки: нет

##### Тело: обновленная информация об уроке

```
{
	"idLesson": 5,
	"subject": {
		"idSubject": 2,
		"name": "Математика"
	},
	"date": "2023-09-04",
	"timeStart": "10:00:00",
	"timeEnd": "10:40:00",
	"theoryUrl": "https://habr.com/ru/practiceUrl.htm",
	"practiceUrl": "https://habr.com/ru/practiceUrl.htm",
	"homeworkUrl": "https://habr.com/ru/practiceUrl.htm",
	"progress": 0,
	"checkSuccessfully": false
}
```

##### Возможные коды ответа:

- 200 - данные успешно обновлены
- 400 - ошибка в запросе
- 403 - нет прав для изменения данных
- 404 - урок не найден
- 500 - неизвестная ошибка сервера

#### Запрос DELETE /users/{userId}/lessons/{lessonId} - удаление урока

##### Специальные заголовки:

Authorization: токен_пользователя

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: нет

##### Возможные коды ответа:

- 204 - урок успешно удален
- 404 - урок не найден
- 403 - нет прав для удаления урока
- 500 - неизвестная ошибка сервера

### Контроллер /subjects

#### Запрос GET /subjects - возвращает список предметов

##### Специальные заголовки: Authorization: токен_пользователя

##### Тело: нет

#### Ответ

##### Специальные заголовки: нет

##### Тело: массив предметов

```
[{
		"subject": {
			"idSubject": 1,
			"name": "Математика"
		}
	},
	{
		"subject": {
			"idSubject": 2,
			"name": "Русский язык"
		}
	},
	{
		"subject": {
			"idSubject": 3,
			"name": "Технология"
		}
	}
]
  ```

##### Возможные коды ответа:

- 200 - данные успешно получены
- 403 - нет прав для получения данных
- 500 - неизвестная ошибка сервера

Если возникла ошибка, то нужно в теле ответа возвращать причину ошибки
